<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>First Puzzle Page</title>
  <style>
    #container
    {
      width:850px;
      border: 2px solid black;
      border-radius: 20px;
      margin:10px auto;
      padding: 10px;
    }
    #piece-container
    {
      width:280px;
      height:225px;
      border:1px solid black;
      float:left;
      text-align: center;
      font-size: 30px;
      line-height: 400px;
      position: relative;
      margin-right: 100px;
    }
    #puzzle-container
    {
      width:280px;
      height:225px;
      border:1px solid black;
      float: right;
      margin-left: 100px;
    }
    ul
    {
      list-style: none;
      text-align: center;
      /* display: flex; */
    }
    li {
      display: inline-block;
    }
    ul button
    {
      width:100px;
      border:1px solid black;
      font-size: 20px;
      border-radius: 5px;
      padding:5px;
      margin-top:10px;
    }
  </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script>
    $(document).ready(function () {
      // Function to create puzzle pieces with images
      function createPuzzlePiece(id, imageUrl) {
        return $('<img>', {
          class: 'puzzle-piece',
          id: 'piece-' + id,
          style: "position:absolute; left: 0",
          src: imageUrl
        });
      }

      // Initial setup: create puzzle pieces with images and append them to the container
      const puzzleImages = [
        'images/piece1.webp',
        'images/piece2.webp',
        'images/piece3.webp',
        'images/piece4.webp',
        'images/piece5.webp',
        'images/piece6.webp',
        'images/piece7.webp',
        'images/piece8.webp',
        'images/piece9.webp',
      ];

      for (let i = 1; i <= 9; i++) {
        const imageUrl = puzzleImages.shift();
        $('#piece-container').append(createPuzzlePiece(i, imageUrl));
      }

      // Function to move every piece but one to their correct positions
      function movePiecesToFinalPositions() {
        const manualadj = 25;
        var position = $('#puzzle-container').offset()
        position.left -= manualadj;

        const finalPositions = {
          'piece-1': { top: '0', left: position.left + 0 + 'px' },
          'piece-2': { top: '0', left: position.left + 93 + 'px' },
          'piece-3': { top: '0', left: position.left + 182 + 'px' },
          'piece-4': { top: '75px', left: position.left + 0 + 'px' },
          'piece-5': { top: '73px', left: position.left + 93 + 'px' },
          'piece-6': { top: '73px', left: position.left + 186 + 'px' },
          'piece-7': { top: '150px', left: position.left + 0 + 'px' },
          'piece-8': { top: '148px', left: position.left + 93 + 'px' },
        };

        // Animate each puzzle piece to its final position
        $.each(finalPositions, function (pieceId, finalPosition) {
          $('#' + pieceId).animate(finalPosition, 2000);
        });
      }

      // Move every piece but one to their correct positions when the page loads
      movePiecesToFinalPositions();

      function animatePiece(direction) {
        const piece = $('#piece-9'); // Assume the last piece is the movable one
        const verticaldist = 50;
        const lateraldist = 50.2;

        // Get the current position of the piece
        var currentPosition = piece.offset();

        // Set boundaries based on the screen size
        var maxX = $(window).width() - piece.width();
        var maxY = $(window).height() - piece.height();

        switch (direction) {
          case 'up':
            if (currentPosition.top - verticaldist >= 0) {
              piece.animate({ top: `-=${verticaldist}px` });
            }
            break;
          case 'down':
            if (currentPosition.top + verticaldist <= maxY) {
              piece.animate({ top: `+=${verticaldist}px` });
            }
            break;
          case 'left':
            if (currentPosition.left - lateraldist >= 0) {
              piece.animate({ left: `-=${lateraldist}px` });
            }
            break;
          case 'right':
            if (currentPosition.left + lateraldist <= maxX) {
              piece.animate({ left: `+=${lateraldist}px` });
            }
            break;
        }
      }

      // Button click event listeners
      $('#up').on('click', function () { animatePiece('up'); });
      $('#down').on('click', function () { animatePiece('down'); });
      $('#left').on('click', function () { animatePiece('left'); });
      $('#right').on('click', function () { animatePiece('right'); });
    })
  </script>
</head>

<body>
  <div id="container">
    <div id="piece-container"></div>
    <div id="puzzle-container"></div>
    <ul id="buttons">
      <!-- <li><button id="animate">Animate</button></li> -->
      <li><button id="up">Up</button></li>
      <li><button id="down">Down</button></li>
      <li><button id="left">Left</button></li>
      <li><button id="right">Right</button></li>
    </ul>
  </div>
</body>

</html>